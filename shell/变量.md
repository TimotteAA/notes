下面的语句为shell的变量定义和`$`使用语法：
```BASH
# 定义变量，shell的变量定义不能有空格,
# 默认是字符串类型
var1="xxxxx"

# 使用变量的值
echo $var1
```

#### 变量引用

```bash
ubuntu@10-7-61-250:~$ music='test'
ubuntu@10-7-61-250:~$ echo $music
test
ubuntu@10-7-61-250:~$ echo ${music} 
test
ubuntu@10-7-61-250:~$ 
```



#### 变量的规则定义

![image-20240917160809649](https://typora-1316630864.cos.ap-shanghai.myqcloud.com/image-20240917160809649.png)

#### 作用域

shell变量的作用域只针对当前shell进程：

```bash
ubuntu@10-9-97-3:~$ echo ${var}
dad
# 开启一个子shell
ubuntu@10-9-97-3:~$ sh
# 默认不能访问父shell的局部变量
$ echo ${var}

$ pstree
systemd─┬─ModemManager───3*[{ModemManager}]
        ├─2*[agetty]
        ├─cron
        ├─dbus-daemon
        ├─multipathd───6*[{multipathd}]
        ├─polkitd───3*[{polkitd}]
        ├─rsyslogd───3*[{rsyslogd}]
        ├─sshd───sshd───sshd───bash───sh───pstree
        ├─systemd───(sd-pam)
        ├─systemd-journal
        ├─systemd-logind
        ├─systemd-network
        ├─systemd-resolve
        ├─systemd-timesyn───{systemd-timesyn}
        ├─systemd-udevd
        └─udisksd───5*[{udisksd}]


```

![image-20240917161022551](https://typora-1316630864.cos.ap-shanghai.myqcloud.com/image-20240917161022551.png)

##### 特殊变量

```bash
$?

# 如果上一条变量成功，0；否则1-255的错误码

ubuntu@10-9-97-3:~$ ls test.sh
test.sh
ubuntu@10-9-97-3:~$ echo $?
0
ubuntu@10-9-97-3:~$ ls test.s
ls: cannot access 'test.s': No such file or directory
ubuntu@10-9-97-3:~$ echo $?
2

```



> 单引号不识别特殊语法+符号
>
> 双引号识别特殊语法+符号

```bash
ubuntu@10-9-97-3:~$ name="hahaha"
ubuntu@10-9-97-3:~$ name2='${name}'
ubuntu@10-9-97-3:~$ name3=“${name}”
ubuntu@10-9-97-3:~$ echo $name2
${name}
ubuntu@10-9-97-3:~$ echo $name3
“hahaha”

```



##### 反引号

shell的反引号可以将命令的执行结果保存在变量中

```bash
# name中保存了ls命令的执行结果
ubuntu@10-9-97-3:~$ name=`ls`
ubuntu@10-9-97-3:~$ ls
test.sh
ubuntu@10-9-97-3:~$ echo $name
test.sh

```



##### 父子shell

1. 通过`bash xx.sh`或者`sh xxx.sh`的方式，开启的是一个子shell
2. 通过`source xx.sh`，在当前的shell进程中执行



### 环境变量

shell通过`export`前缀将变量声明为环境变量，子shell也能访问

shell通过环境变量确定的登录命令行、PATH路径

环境变量可以在命令行中永久创建，但是用户`exit`退出shell，则丢失。如果需要永久生效，则需要改动配置文件

* 编辑个人文件：`~/.bash_profile`、`~/.bashrc`

```bash
ubuntu@10-9-97-3:~$ export pwd='hahaha'
ubuntu@10-9-97-3:~$ echo $pwd
hahaha
ubuntu@10-9-97-3:~$ exit
logout
Connection to 106.75.3.111 closed.

timotte@DESKTOP-4I74AUT MINGW64 ~
$ ssh ubuntu@106.75.3.111
ubuntu@106.75.3.111's password:
Welcome to Ubuntu 24.04 LTS (GNU/Linux 6.8.0-31-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Sep 17 16:29:58 CST 2024

  System load:  0.0               Processes:             114
  Usage of /:   7.3% of 18.33GB   Users logged in:       0
  Memory usage: 14%               IPv4 address for eth0: 10.9.97.3
  Swap usage:   0%


Last login: Tue Sep 17 16:13:40 2024 from 101.88.104.137
To run a command as administrator (user "root"), use "sudo <command>".
See "man sudo_root" for details.

ubuntu@10-9-97-3:~$ echo $pwd

ubuntu@10-9-97-3:~$


```



##### 环境变量相关的命令

* set，输出当前会话所有变量，包括全局变量、局部变量
* env，只显示全局变量
* declare，输入所有的变量，等于set
* export，显示和设置环境变量值（查看环境变量值，配合grep做查找）

```bash
ubuntu@10-9-97-3:~$ export | grep P
declare -x LESSOPEN="| /usr/bin/lesspipe %s"
declare -x OLDPWD
declare -x PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin"
declare -x PWD="/home/ubuntu"
declare -x XDG_SESSION_TYPE="tty"

```



##### 撤销环境变量

* unset变量名，删除变量或函

##### 设置只读变量

* readonly，只有shell结束，只读变量失效

```bash
ubuntu@10-9-97-3:~$ readonly pd1='123'
ubuntu@10-9-97-3:~$ export pd1='4'
-bash: pd1: readonly variable

```





##### 特殊环境变量：

###### ![image-20240917164201350](https://typora-1316630864.cos.ap-shanghai.myqcloud.com/image-20240917164201350.png)

```bash
# test1.sh
#! /bin/bash
#
echo '--特殊变量 $0 $1 $2 .. 的实践'
echo "结果: $0 $1 $2"

echo "###############################"
echo ‘$# 获取参数总个数’

echo '###############################'
echo '特殊环境变量$* 实践'
echo $*

echo '###############################'
echo '特殊环境变量$@ 实践'
echo $@


```



